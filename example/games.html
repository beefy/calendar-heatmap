<html>

<head>
  <meta charset="utf-8">
  <title>D3.js v4 Calendar Heatmap</title>
  <link rel="stylesheet" type="text/css" href="../src/calendar-heatmap.css">
</head>

<body>
  <div class="container"></div>
  <div class="container2"></div>
  <div class="container3"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js" charset="utf-8"></script>
  <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
  <script src="../src/calendar-heatmap.js"></script>
  <script type="text/javascript">

	  var data = {'2017.05.13': 1, '2017.07.24': 2, '2017.08.22': 1, '2016.08.05': 15, '2017.08.16': 5, '2018.03.06': 1, '2018.03.04': 16, '2017.08.20': 4, '2018.03.01': 5, '2018.01.01': 4, '2018.01.02': 1, '2018.01.03': 2, '2016.08.09': 1, '2018.01.05': 1, '2016.10.08': 2, '2016.10.09': 5, '2017.09.15': 21, '2016.10.04': 2, '2017.08.09': 1, '2018.01.12': 3, '2016.11.26': 4, '2017.01.30': 7, '2017.11.30': 27, '2018.07.03': 1, '2018.07.01': 1, '2018.07.04': 7, '2018.07.05': 23, '2018.03.15': 13, '2016.10.17': 1, '2018.03.17': 5, '2017.06.27': 1, '2017.05.21': 1, '2018.01.19': 12, '2018.01.18': 13, '2018.01.16': 7, '2016.10.26': 3, '2018.03.19': 2, '2018.03.18': 4, '2018.01.11': 2, '2018.01.10': 35, '2017.07.16': 24, '2018.01.08': 1, '2017.08.15': 1, '2017.07.15': 9, '2017.09.08': 17, '2017.08.12': 20, '2017.07.10': 12, '2017.11.29': 47, '2016.10.19': 7, '2017.08.19': 46, '2017.08.18': 14, '2017.09.20': 11, '2018.05.20': 5, '2018.05.21': 3, '2017.09.24': 4, '2017.09.27': 3, '2017.09.26': 5, '2017.09.29': 5, '2017.09.28': 10, '2018.05.28': 9, '2018.05.29': 16, '2016.12.06': 1, '2016.11.28': 1, '2018.03.28': 2, '2018.03.29': 15, '2017.10.26': 27, '2018.07.14': 60, '2018.03.20': 2, '2018.03.22': 1, '2018.03.23': 3, '2018.03.24': 24, '2018.03.25': 12, '2018.03.26': 11, '2018.03.27': 6, '2017.07.27': 2, '2018.09.02': 3, '2017.08.29': 10, '2017.07.18': 1, '2018.02.12': 2, '2018.02.13': 4, '2018.02.10': 66, '2018.02.11': 45, '2018.02.16': 42, '2018.02.17': 2, '2018.02.14': 11, '2018.02.15': 3, '2017.11.06': 5, '2017.11.07': 55, '2017.11.04': 50, '2017.11.05': 5, '2017.11.02': 3, '2017.11.03': 27, '2017.07.03': 2, '2017.11.01': 22, '2017.11.24': 1, '2017.11.08': 46, '2017.11.09': 34, '2017.09.14': 5, '2017.10.15': 12, '2017.09.16': 39, '2017.09.17': 19, '2017.09.10': 22, '2017.09.11': 10, '2017.09.12': 6, '2017.09.13': 26, '2017.07.19': 1, '2017.09.18': 2, '2018.07.27': 4, '2018.07.21': 4, '2018.07.22': 4, '2018.04.22': 1, '2017.05.06': 12, '2016.08.20': 2, '2018.07.28': 11, '2018.07.29': 5, '2018.04.28': 6, '2018.06.16': 1, '2018.06.17': 58, '2018.06.14': 2, '2018.06.12': 4, '2018.06.10': 3, '2018.06.11': 7, '2018.02.01': 257, '2018.02.03': 121, '2018.02.02': 117, '2018.02.05': 119, '2018.02.04': 119, '2018.02.07': 106, '2018.02.06': 114, '2017.11.15': 60, '2018.02.09': 45, '2017.11.17': 56, '2017.11.16': 17, '2017.11.11': 27, '2017.11.10': 22, '2017.11.13': 9, '2018.02.08': 106, '2017.09.03': 29, '2017.12.10': 71, '2017.09.01': 33, '2017.11.19': 183, '2017.11.18': 55, '2017.09.05': 22, '2017.09.04': 46, '2018.05.05': 27, '2018.05.06': 15, '2018.05.07': 5, '2016.10.05': 19, '2017.12.30': 1, '2017.12.31': 6, '2018.05.08': 13, '2017.10.10': 8, '2016.12.22': 1, '2018.06.05': 5, '2018.06.04': 3, '2018.06.06': 4, '2016.11.29': 2, '2017.10.14': 1, '2018.06.03': 3, '2018.06.02': 21, '2017.11.20': 26, '2017.11.21': 10, '2017.11.22': 27, '2017.11.23': 7, '2018.06.09': 28, '2017.11.25': 16, '2017.11.26': 152, '2017.11.27': 55, '2018.08.15': 6, '2018.05.19': 68, '2017.10.19': 24, '2018.08.11': 3, '2018.08.13': 16, '2018.05.13': 42, '2018.05.12': 42, '2018.05.11': 5, '2018.05.10': 4, '2017.10.16': 2, '2017.10.17': 10, '2018.05.15': 3, '2018.05.14': 7, '2017.07.22': 8, '2017.07.23': 2, '2017.12.21': 5, '2017.12.20': 2, '2017.12.22': 4, '2017.12.25': 21, '2017.12.24': 45, '2017.12.26': 22, '2017.08.21': 1, '2017.11.14': 41, '2017.09.09': 21, '2018.02.23': 10, '2018.02.22': 50, '2018.02.21': 4, '2018.02.20': 3, '2018.02.27': 7, '2018.02.26': 2, '2018.02.25': 14, '2018.02.24': 11, '2017.10.27': 12, '2016.11.27': 13, '2018.02.28': 7, '2017.11.28': 10, '2018.08.06': 1, '2018.08.05': 15, '2018.08.04': 1, '2017.10.09': 2, '2017.10.08': 25, '2017.07.06': 4, '2017.10.03': 11, '2017.11.12': 93, '2017.10.05': 9, '2018.02.18': 2, '2017.10.06': 12, '2017.07.25': 1, '2017.12.18': 9, '2017.12.19': 14, '2017.09.02': 59, '2017.12.14': 21, '2017.12.15': 2, '2017.12.16': 1, '2018.04.14': 3, '2017.12.11': 20, '2017.07.17': 4, '2017.12.13': 8, '2016.09.13': 1, '2016.09.12': 12, '2016.09.15': 1, '2016.09.14': 2, '2016.09.17': 1, '2016.09.16': 1, '2017.09.07': 2, '2018.06.24': 13, '2018.06.23': 18, '2018.06.21': 3, '2018.06.20': 1, '2016.11.05': 4, '2017.06.30': 8, '2017.05.12': 1, '2016.11.09': 4, '2018.01.24': 1, '2016.10.29': 9, '2018.01.20': 37, '2018.01.21': 1, '2017.08.26': 40, '2017.08.27': 44, '2017.08.24': 16, '2017.08.25': 51, '2017.10.30': 26, '2017.10.31': 5, '2018.01.28': 52, '2018.01.29': 4, '2017.12.03': 13, '2017.12.02': 54, '2017.12.01': 78, '2017.12.07': 32, '2017.12.06': 113, '2017.12.05': 44, '2018.04.08': 7, '2018.04.07': 4, '2017.12.09': 77, '2017.12.08': 76, '2018.04.02': 5, '2017.07.02': 6, '2017.10.18': 2, '2016.09.23': 2, '2016.11.03': 2, '2016.10.28': 5, '2017.08.13': 22, '2017.09.06': 8, '2016.07.12': 1, '2016.08.11': 4, '2017.01.09': 4, '2017.10.12': 1, '2017.10.22': 29, '2017.10.21': 35, '2018.01.31': 20, '2018.01.30': 2, '2017.10.25': 19, '2017.10.24': 21, '2016.10.31': 1, '2016.10.30': 11, '2017.10.28': 47, '2017.08.31': 37, '2016.12.21': 2, '2016.10.22': 4, '2017.08.28': 55}

    var getDateStr = function(dateElement) {
      var day = dateElement.getDate()
      var month = dateElement.getMonth()
      var year = dateElement.getFullYear()
      if(day < 10) { day = "0"+day }
      if(month < 10) { month = "0"+month }
      return data[year + "." + month +"." + day]
    }

    var chartData = function(start,end) {
      return d3.timeDays(start, end).map(function (dateElement) {
        return {
           date: dateElement,
           count: getDateStr(dateElement)
        };
      });
    }

    var yearsAgo = function(numYearsAgo) {
      if(numYearsAgo == 0) return moment().endOf('day').toDate();
      return moment().startOf('day').subtract(numYearsAgo, 'year').toDate();
    }

    var heatmapInit = function(count,container) {
      var startDate = yearsAgo(count+1)
      var endDate = yearsAgo(count)
      var data = chartData(startDate,endDate)
      var heatmap = calendarHeatmap()
        .data(data)
        .selector(container)
        .tooltipEnabled(true)
        .colorRange(['#f4f7f7','#239a3b'])
        .startDate(startDate)
      heatmap();
    }

    //.colorRange(['#f4f7f7', '#79a8a9'])
    heatmapInit(0,'.container')
    heatmapInit(1,'.container2')
    heatmapInit(2,'.container3')
  </script>
</body>

</html>
